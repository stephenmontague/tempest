spring:
     application:
          name: ims

     # Database (defaults - overridden by profiles)
     datasource:
          url: jdbc:postgresql://localhost:5432/tempest_ims
          username: ${DB_USERNAME}
          password: ${DB_PASSWORD}
          driver-class-name: org.postgresql.Driver

     # JPA
     jpa:
          hibernate:
               ddl-auto: validate
          show-sql: false
          properties:
               hibernate:
                    dialect: org.hibernate.dialect.PostgreSQLDialect
                    format_sql: true

     # Flyway
     flyway:
          enabled: true
          locations: classpath:db/migration
          baseline-on-migrate: true

     # Security - OAuth2 Resource Server
     security:
          oauth2:
               resourceserver:
                    jwt:
                         issuer-uri: ${JWT_ISSUER_URI:}
                         jwk-set-uri: ${JWT_JWK_SET_URI:}

# Custom security settings
app:
     security:
          audience: tempest-api
          dev-bypass: ${SECURITY_DEV_BYPASS:false}

# Server
server:
     port: 8081

# Actuator
management:
     endpoints:
          web:
               exposure:
                    include: health,info
     endpoint:
          health:
               show-details: when-authorized
     health:
          db:
               enabled: true

# Temporal (defaults - overridden by profiles)
# Authentication options (use one):
#   1. API Key: Set TEMPORAL_API_KEY
#   2. mTLS: Set TEMPORAL_CLIENT_CERT and TEMPORAL_CLIENT_KEY
#   3. Local dev: Leave both unset
temporal:
     namespace: ${TEMPORAL_NAMESPACE:default}
     address: ${TEMPORAL_ADDRESS:localhost:7233}
     api-key: ${TEMPORAL_API_KEY:}
     client:
          cert: ${TEMPORAL_CLIENT_CERT:}
          key: ${TEMPORAL_CLIENT_KEY:}
     worker:
          task-queue: ims-task-queue
          enabled: true
